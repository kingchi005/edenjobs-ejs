<%- include('./partials/head.ejs') %>
<main class="m-auto">
	<div>
		<div class="lg:flex-1">
			<div class="border bg-white p-12 max-w-7xl m-auto">
				<button
					onclick="history.back()"
					type="button"
					data-te-ripple-init
					data-te-ripple-color="light"
					class="flex justify-between gap-3 items-center rounded mb-5 border-2 border-info-800 px-3 pb-[6px] pt-2 text-xs font-medium uppercase leading-normal text-info-800 transition duration-150 ease-in-out hover:border-info-800 hover:bg-info-500 hover:bg-opacity-10 hover:text-info-800 focus:border-info-800 focus:text-info-800 focus:outline-none focus:ring-0 active:border-info-900 active:text-info-900 dark:border-info-900 dark:text-info-900 dark:hover:border-info-900 dark:hover:bg-info-100 dark:hover:bg-opacity-10 dark:hover:text-info-900 dark:focus:border-info-900 dark:focus:text-info-900 dark:active:border-info-900 dark:active:text-info-900"
				>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						viewBox="0 0 24 24"
						fill="currentColor"
						class="w-6 h-6"
					>
						<path
							fill-rule="evenodd"
							d="M11.03 3.97a.75.75 0 0 1 0 1.06l-6.22 6.22H21a.75.75 0 0 1 0 1.5H4.81l6.22 6.22a.75.75 0 1 1-1.06 1.06l-7.5-7.5a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 0 1 1.06 0Z"
							clip-rule="evenodd"
						/>
					</svg>

					Back
				</button>

				<div
					class="flex flex-col justify-start gap-10 rounded-md transition duration-200 md:flex-row md:justify-between md:gap-0"
				>
					<div class="sm:flex justify-center items-center gap-6">
						<div class="flex-1 mb-5 justify-center">
							<div class="w-fit flex-1 flex justify-center items-center mb-5">
								<img
									alt="SalesPlat Recruitment logo"
									src="<%= applicationDetails.applicant.avatar %>"
									class="rounded-xl min-w-full"
									width="350"
									height="350"
									decoding="async"
									data-nimg="1"
									loading="lazy"
									style="color: transparent"
								/>
							</div>
							<div class="flex-1">
								<div class="flex items-start justify-between">
									<div>
										<h2 class="text-left text-2xl font-bold sm:text-xl">
											<%= applicationDetails.applicant.user?.first_name+" "+
											applicationDetails.applicant.user?.last_name %>
										</h2>
										<p
											class="flex items-center text-left text-xs text-gray-400 sm:text-sm"
										>
											<button type="button" class="hover:underline">
												<%= applicationDetails.applicant.user.email %>
											</button>
										</p>
										<p
											class="flex items-center text-left text-xs text-gray-800 sm:text-sm"
										>
											<%= applicationDetails.applicant.user.address %>
										</p>
									</div>
								</div>
								<div
									class="items mt-2 flex flex-wrap items-center gap-1 whitespace-nowrap text-[10px]"
								>
									<span class="text-xs">Qualifications: </span>
									<!-- prettier-ignore -->
									<% JSON.parse(`${applicationDetails?.applicant?.qualifications}`).map((item,i) => {%>
									<span class="text-blue-400" id="no-of-applicant">
										<%= item %>
									</span>

									<!-- prettier-ignore -->
									<% if ( i < JSON.parse(`${applicationDetails?.applicant?.qualifications}`).length-1) { %>
									<div class="text-base text-gray-400">
										<svg
											stroke="currentColor"
											fill="currentColor"
											stroke-width="0"
											viewBox="0 0 16 16"
											height="1em"
											width="1em"
											xmlns="http://www.w3.org/2000/svg"
										>
											<path
												d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"
											></path>
										</svg>
									</div>
									<% } %>
									<!--  -->
									<% }) %>
									<div class="flex flex-wrap justify-start gap-5 mt-5">
										<h4 class="text-xs">Skills</h4>
										<!-- prettier-ignore -->
										<% JSON.parse(applicationDetails.applicant.skill_set).map(el=>{ %>
                  <%- include('../components/badge',{text:el}) %>
                <% }) %>
									</div>
								</div>
							</div>
						</div>
						<div
							class="border h-full w-full rounded-lg text-center bg-white p-6 mb-5 dark:bg-neutral-700 flex-1"
						>
							<h2 class="text-xl font-semibold mb-5">CV / Resume</h2>
							<div class="w-full flex-1 h-full">
								<iframe
									id="view-cv"
									src="<%= applicationDetails.applicant.cv_resume_url %>"
									width="100%"
									height="90%"
									style="border: none"
								></iframe>
							</div>
						</div>
					</div>
				</div>
				<section class="p-5 mb-5">
					<h6 class="my-4 font-semibold text-xl">Cover Letter</h6>
					<div class="px-5"><%= applicationDetails.content %></div>
				</section>
				<div
					class="mt-10 grid gap-4 rounded-lg border border-[#E6E5E5] py-6 px-4 md:grid-cols-3 md:flex-row"
				>
					<div class="border-r border-[#E6E5E5] px-2">
						<p class="whitespace-nowrap text-xs">Job stability</p>
						<p
							class="mt-1 cursor-pointer truncate whitespace-nowrap text-sm font-medium capitalize"
							aria-label="Lagos"
						>
							<%= applicationDetails.applicant.job_stability %>
						</p>
						<!-- <hr class="my-2" /> -->
						<!-- <p class="whitespace-nowrap text-xs">Skill Level</p>
						<p class="mt-1 whitespace-nowrap text-sm font-medium">
							Bachelor's Degree
						</p> -->
					</div>
					<div class="border-r border-[#E6E5E5] px-2">
						<p class="whitespace-nowrap text-xs">Experience Level</p>
						<p
							class="mt-1 whitespace-nowrap text-sm font-medium line-clamp-1 capitalize"
						>
							<%= applicationDetails.applicant.skill_level %>
						</p>
						<!-- <hr class="my-2" /> -->
						<!-- <p class="whitespace-nowrap text-xs">Experience Length</p>
						<p class="mt-1 whitespace-nowrap text-sm font-medium">
							<%#= job.required_experience_years %> years
						</p> -->
					</div>
					<div class="px-2">
						<p class="whitespace-nowrap text-xs">Prefered Employment Type</p>
						<p class="mt-1 whitespace-nowrap text-sm font-medium capitalize">
							<%= applicationDetails.applicant.preferred_job_type %> (<%=
							applicationDetails.applicant.Job_location?"Remote":"Onsite"%>)
						</p>
						<!-- <hr class="my-2" /> -->
						<!-- <p class="whitespace-nowrap text-xs">Salary</p>
						<p class="mt-1 whitespace-nowrap text-sm font-medium line-clamp-1">
							₦<%#= job.min_salary %>
							<span> - ₦<%#= job.max_salary %> </span>
							<span> (<%#= job.salary_period %>) </span>
						</p> -->
					</div>
				</div>
				<div x-data="Invite" class="mx-auto">
					<button
						@click="sendInvite"
						type="button"
						class="inline-block rounded bg-primary-700 border-primary px-6 pb-[6px] pt-2 text-xs font-medium uppercase leading-normal text-primary-50 transition duration-150 ease-in-out hover:border-primary-600 hover:bg-neutral-500 hover:bg-opacity-10 hover:text-primary-600 focus:border-primary-600 focus:outline-none focus:ring-0 active:border-primary-700 active:text-primary-700 dark:hover:bg-neutral-100 dark:hover:bg-opacity-10"
						data-te-ripple-init
						x-text="text"
						data-te-ripple-color="light"
					></button>
				</div>
			</div>
		</div>
	</div>
</main>

<%- include('./partials/footer.ejs') %>

<script>
	document.addEventListener("alpine:init", () => {
		Alpine.data("Invite", () => ({
			text: "Invite for interview",
			async sendInvite() {
				const url = "/api/job-application/invite/<%= applicationDetails.id %>";
				const res = await (await fetch(url, { method: "put" })).json();

				if (res.ok) {
					showToast({ type: "success", text: res.message });
				} else {
					showToast({ type: "error", text: res.error.message });
				}
			},
		}));
	});
</script>
